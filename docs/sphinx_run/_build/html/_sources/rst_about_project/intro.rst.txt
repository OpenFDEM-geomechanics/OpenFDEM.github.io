What is OpenFDEM
==============================

OpenFDEM aims to be a free finite and discrete element solver with object-oriented architecture for solving
**multiscale, multiphase, and multiphysics** (3M) problems. The applications are, 
but not limited to, mechanical, thermal and fluid mechanics problems. The main features are:

**Modular & Extensible FEM Kernel and DEM Kernel** (OPENFDEMlib)

•	**Fully extendable and portable** - The kernel can be extended in any "direction". Adding new element types, new material models with any number of element types and internal history parameters, new boundary conditions (time-dependent, position-dependent, state-dependent, periodic and flow-in/out) or numerical algorithms (explicit and implicit) is possible, as well as the ability to add and manage arbitrary degrees of freedom is a matter of course. (It is not a Y-like code limited to constant-strain triangular elements, Q4 cohesive elements and triangle-triangle contacts; OpenFDEM is intended to be a more general FEM/DEM solver compatible with arbitrary scenarios.) Like other common open-source FEM solvers, the most important feature of OpenFDEM is its standardization and generality, which allows the continuum-discontinuum method to be used with more general scenarios.

.. figure:: ../../images/Introduction/elementtype.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    OpenFDEM supports 26 element types and 24 materials.

|
•	**Flexible element definition** - OpenFDEM is not limited only to triangular elements, but allows Q4 cohesive element and triangle-triangle contact. OpenFDEM is a more general FEM/DEM solver can be compatible to arbitrary scenarios.

.. figure:: ../../images/Introduction/elementshape.png
    :alt: Element Type
    :align: center
    :scale: 50%

    Quadratic elements are supported in OpenFDEM. Combined linear element (quadrilateral and triangle elements, left), quadratic quadrilateral element (middle) and refined linear quadrilateral element (right).

|

•	**Highly accurate and reliable** – The kernel can be extended in any "direction". Adding new element types, new material models with any number of element types and internal history parameters, new boundary conditions (time-dependent, position-dependent, state-dependent, periodic and flow-in/out) or numerical algorithms (explicit and implicit) is possible, as well as the ability to add and manage arbitrary degrees of freedom is a matter of course. (It is not a Y-like code limited to constant-strain triangular elements, Q4 cohesive elements and triangle-triangle contacts; OpenFDEM is intended to be a more general FEM/DEM solver compatible with arbitrary scenarios.) Like other common open-source FEM solvers, the most important feature of OpenFDEM is its standardization and generality, which allows the continuum-discontinuum method to be used with more general scenarios.
•	**Friendly preprocessing interface** - The Gmsh is provided to easily create meshes from computer-aided design (CAD), geometry file and third-party commercial software. The built-in commands are accessible to create many basic geometries (e.g. rectangular, circle, ellipse, polygon, line and particles) and initial discontinuities (e.g. single joint, joint sets, DFNs and DFNs from image mapping). This built-in mesh module can quickly assess mesh quality and identify the local bad meshes which will be further optimized by swap, node insertion, node delete, element split techniques, automatically or manually. Meanwhile, for very complex geometric models, users can also import mesh files from third-party software. OpenFDEM supports importing standard mesh files, such as .msh, .inp, .stl, .dxf and .step, etc. Principally, the geometry file can be processed by Gmsh can also be done by OpenFDEM.
•	**Parallel processing support** - Most modules can be operated in parallel and very good performance scalability on various platforms. Instead of using no binary searching (NBS) contact method in OpenFDEM, a new element-wise contact searching algorithm with a complexity of O(NlogN) is proposed to make the contact searching process parallelable. The GPU acceleration will also be added shortly.
•	**Mesh adaptive analysis support** – Local adaptive mesh refinement (lAMR) and global adaptive mesh refinement(gAMR) are provided in OpenFDEM for mesh optimization and accuracy enhancement. Based on different remeshing criteria, OpenFDEM supports various error estimations, such as primary unknown, internal variables mapping, high-accuracy internal variable interpolation and fast unbalance equilibrium after refinement. The AMR supports fracture path consistent before and after remeshing.

.. figure:: ../../images/Introduction/AMR.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Global adaptive mesh refinement (up-left) and local adaptive mesh refinment (down-right) in OpenFDEM.

|

.. figure:: ../../images/Introduction/wavebetter.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Flowing mesh refined based on the stress level in the bar.

| 

•	**Rich grain-based modelling support** – Voronoi tessellations can be created with the built-in Voronoi module. The optimization is deployed to match the laboratorial mineral distribution from measurements or digital image. The realistic grain-based model (GBM) can be reproduced directly in the project by inputting the binary sample images. The polygonal element type is available for representing the whole mineral individually. Furthermore, transgranular fracturing can be realized by element splitting techniques.

.. figure:: ../../images/Introduction/voronoi.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    OpenFDEM implements a Voronoi lib and is able to simulate grains directly based on polygonal elements.

|

•	**Large material library including the state-of-the-art models for phase field of quasibrittle materials and rich element library** – currently, OpenFDEM supports 17 element materials (spanning elastic, hyperelastic, plastic, damage, nonlocal, viscous and phas—field models), 7 cohesive materials (spanning static, dynamic and fatigue problems), and 6 contact models (including Mohr-coulomb friction, hertz contact, rate friction, rough dilation shear law and so on). (The OpenFDEM is the only code supports materials beyond the community of rock mechanics)

.. figure:: ../../images/Introduction/feature2.png
    :alt: Element Type
    :align: center
    :scale: 18% 

| 

.. figure:: ../../images/Introduction/feature.png
    :alt: Element Type
    :align: center
    :scale: 18% 

    New material library in OpenFDEM.

| 

.. figure:: ../../images/Introduction/globalAMRPhase.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Phasefield module in OpenFDEM.

|

•	**Advanced Analysis Solvers** - Linear dynamic solver (implicit and explicit), linear static solver (PETSC), eigenvalue problem (SLEPc), and nonlinear dynamic solver (explicit) are applicable for different problems (The OpenFDEM is the only project provides implicit solver for FDEM-like codes), the implicit solver currently can be run on Linux-like OS.

**Particle Discrete Element Method (pDEM)**

•	**Rigid DEM support** - built-in module for rigid particles packing, kinematics and collision, the particle-based contact models include linear, Hertz, cohesive bond and rotation resistance model.

.. figure:: ../../images/Introduction/PDEM.png
    :alt: Element Type
    :align: center
    :scale: 18% 

    Sand compression test with membrane (left) and irregular deformable and breakable particles packing (right).

|

•	**Realistic Particle Modelling** - Overlapping particles and Fourier-Voronoi-based algorithm are used to generate realistic particles having complex shapes. The realistic particles can be rigid or deformable. The breakage of the particles are also possible.

.. figure:: ../../images/Introduction/landslide.gif
    :alt: Element Type
    :align: center
    :scale: 18%

    Debris flow of rigid particles due to gravity (left) and debris flow of irregular deformable fragments due to gravity (right, stl file from itasca).

|

**Fluid Dynamic Module**

•	**Analysis Procedures** -  Matrix flow for pore seepage, transient incompressible fracture flow, transient compressible fracture flow and gas flow problems.

.. figure:: ../../images/Introduction/gasblast.gif
    :alt: Element Type
    :align: center
    :scale: 40% 

    Blast considering gas expansion, gas flow by hydro module (left) and without gas expansion by mechanical module (right).

|

•	**Element Library** - Triangle, quadratic triangle, quadrilateral and quadratic quadrilateral element types are supported for Newtonian fluid and Bingham fluid.  

.. figure:: ../../images/Introduction/Hydraulic.gif
    :alt: Element Type
    :align: center
    :scale: 15% 

    Fluid injection in fractured rock block.

|

•	**Boundary Types** - Water level, pore pressure, flow rate, steady flow and impermeable boundary conditions are supported in hydro module. 

.. figure:: ../../images/Introduction/tube.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Water flowing in a tube using CFD in hydro module.

|


**Thermal Transportation Module**

•	**Analysis procedures** - Matrix thermal transportation, thermal resistance in fractures, heat conduction of fluid in fracture, heat advection of fluid, heat exchange between solid and fluid and contact thermal problems.

.. figure:: ../../images/Introduction/microwavethermal.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Gabbro fracturing after microwave treatment in thermal module.

|

•	**Element Library** - Triangle, quadratic triangle, quadrilateral and quadratic quadrilateral element types are supported.  
•	**Boundary Types** - Constant temperature, flux, conduction, advection, radiation, source and adiabatic thermal conditions are supported. 

**Computational Fluid Dynamics**

•	**Material Point Method (MPM)** - is used to simulate the fluid transportation and large deformation. This mesh-free method does not encounter the drawbacks of mesh-based methods (high deformation tangling, advection errors etc.) which makes it a promising and powerful tool for large deformation problems. The coupling among FDEM and MPM makes the solid interacting with fluid is possible.

.. figure:: ../../images/Introduction/tapwater.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Tapwater flow into a tank, MPM + FDEM.

|

.. figure:: ../../images/Introduction/vortex.gif
    :alt: Element Type
    :align: center
    :scale: 40%

    Kármán vortex street example, periodic boundary.

|

Post-Processing
------------------------------------------

- Export to VTK format for postprocessing on VTK based visualization tools such as ParaView is supported.
- Export to Tecplot format is supported.
- Export historic variables which are monitored at each step to .csv is supported.


Third-Party Packages Used in OpenFDEM
------------------------------------------

•	``GMSH`` - 2D and 3D mesh generator
•	``GSL`` - mathematical routines
•	``Eigen`` - matrix calculation
•	``PETSC`` - Portable, Extensible Toolkit for Scientific Computation
•	``ParaView`` - Parallel Visualization Application (for .vtk files)


Documentation
------------------

The documentation is auto-generated from the ``.of`` and ``.rst`` files throughout
the codebase and the extensive comments in the source code ``.h`` and ``.of`` files. Sphinx is used to compile
the documentation in HTML and PDF formats.
<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Tutorial : Pressure Method" href="pressure.html" /><link rel="prev" title="Tutorial 3: Create Uniaxial Compression Test with Quadrangle Element" href="tutorial3_UCS_Test_with_Quadrangle_Elements.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.05.20 -->
        <title>Tutorial 4: Apply In-situ Stress - OpenFDEM Solver 0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">OpenFDEM Solver 0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">OpenFDEM Solver 0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst_about_project/intro.html">Features and About OpenFDEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_about_project/requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_about_project/started.html">Quick Start for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_about_project/copyrights.html">Copyright</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial1_UCS_Test.html">Tutorial 1: Create Uniaxial Compression Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial2_UCS_with_Gmsh.html">Tutorial 2: UCS model from Gmsh</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial3_UCS_Test_with_Quadrangle_Elements.html">Tutorial 3: Create Uniaxial Compression Test with Quadrangle Element</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial 4: Apply In-situ Stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="pressure.html">Tutorial : Pressure Method</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html">general commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#config">config</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#geometry">geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#mesh-insert">mesh_insert</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#nodal">nodal</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#element">element</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#contact">contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#cohelement">cohelement</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#group">group</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#boundary">boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#material">material</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#gbm">gbm</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#history">history</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#dfn">dfn</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#table">table</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#damping">damping</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#id5">hydro</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#gravity">gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_guide.html#seismic">seismic</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst_developer/developer.html">Common class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_developer/developer.html#geometry-class">Geometry class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_developer/developer.html#solid-class">Solid class</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst_developer/appendix.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tutorial-4-apply-in-situ-stress">
<h1>Tutorial 4: Apply In-situ Stress<a class="headerlink" href="#tutorial-4-apply-in-situ-stress" title="Permalink to this heading">#</a></h1>
<p>In-situ stress is applied to model the original state of the rock before excavation or disturbtion.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/Apply_Insitu_Stress.png"><img alt="Geometry of the Rock and Excavation" src="../_images/Apply_Insitu_Stress.png" style="width: 537.0px; height: 503.4px;" /></a>
<figcaption>
<p><span class="caption-text">Figure 1: Geometry of the Rock and Excavation</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="main-steps">
<h2>1.0 Main Steps<a class="headerlink" href="#main-steps" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Initialize the model</p></li>
<li><p>Import mesh</p></li>
<li><p>Create groups</p></li>
<li><p>Assign material properties</p></li>
<li><p>Assign boundaries</p></li>
<li><p>Setup output</p></li>
<li><p>Execute model</p></li>
</ol>
</section>
<section id="codes">
<h2>2.0 Codes<a class="headerlink" href="#codes" title="Permalink to this heading">#</a></h2>
<p>Please note that, all the setting in the example is based on the developer’s computer. You may need to change
these setting based on your own conditions.</p>
<p>To start with programming, create a new empty text file (later add the <cite>.of</cite> extension). Begin writing the following commands:</p>
<section id="initialize-the-model">
<h3>2.1 Initialize the model<a class="headerlink" href="#initialize-the-model" title="Permalink to this heading">#</a></h3>
<ol class="arabic">
<li><dl>
<dt>Create a new run and clean up the old memories.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">new</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Set up the folder name to save your results. Here the folder name is set to be “result”.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">result</span> <span class="s2">&quot;result&quot;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Set the number of cores to be used for running this model.</dt><dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In this example, 15 cores will be used for running. To prevent the crushing of your computer, please
check your computer to fill in the number of cores you want to use from your computer. To check the number
of cores your computer has, you can go Task Manager &gt; Performance &gt; CPU &gt; Cores. If nothing is set here,
serial computing will be used.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">omp</span> <span class="mi">15</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
<section id="create-the-geometry-and-the-mesh">
<h3>2.2 Create the geometry and the mesh<a class="headerlink" href="#create-the-geometry-and-the-mesh" title="Permalink to this heading">#</a></h3>
<ol class="arabic">
<li><dl>
<dt>See Figure 1, we will create a square rock model with a 0.05 m radius hole at the center of the rock.</dt><dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Circles in OpenFDEM are defined by four values: x coordinate, y coordinate, radius and the number of segments. Users can define a circle by entering <strong>[x_value y_value radius #_of_segements]</strong>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">square</span> <span class="s1">&#39;rock&#39;</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">cut</span><span class="o">.</span><span class="n">circle</span> <span class="s1">&#39;hole&#39;</span> <span class="s1">&#39;rock&#39;</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.05</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Set the mesh size and the default method to create the mesh</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">size</span> <span class="s1">&#39;default&#39;</span> <span class="mf">0.03</span>
<span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">mesh</span> <span class="n">auto</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Group the elements which will be excavated later.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">element</span> <span class="s1">&#39;excavation&#39;</span> <span class="nb">range</span> <span class="n">circle</span><span class="o">.</span><span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.05</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
<section id="assign-material-properties">
<h3>2.3 Assign Material Properties<a class="headerlink" href="#assign-material-properties" title="Permalink to this heading">#</a></h3>
<dl>
<dt>Set the material properties as shown below.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">element</span> <span class="s1">&#39;default&#39;</span> <span class="n">elastic</span> <span class="n">den</span> <span class="mi">2700</span> <span class="n">E</span> <span class="mf">30e9</span> <span class="n">v</span> <span class="mf">0.3</span> <span class="n">damp</span> <span class="mf">1.0</span>
<span class="n">of</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">contact</span> <span class="s1">&#39;default&#39;</span> <span class="n">MC</span> <span class="n">fric</span> <span class="mf">0.3</span>
</pre></div>
</div>
</dd>
</dl>
</section>
<section id="group-the-edges">
<h3>2.4 Group the Edges<a class="headerlink" href="#group-the-edges" title="Permalink to this heading">#</a></h3>
<dl>
<dt>Group the four boundaries of the model for applying the in-situ stresses and boundary conditions later.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;bottom&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;up&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;left&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;right&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</section>
<section id="assign-boundary-conditions">
<h3>2.5 Assign Boundary Conditions<a class="headerlink" href="#assign-boundary-conditions" title="Permalink to this heading">#</a></h3>
<ol class="arabic">
<li><dl>
<dt>For this example, 30 MPa compressive stress in the xx direction and 5 MPa compressive stresses in the yy direction are assigned to the rock.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">stress</span> <span class="p">[</span><span class="n">rock</span><span class="p">]</span> <span class="n">xx</span> <span class="o">-</span><span class="mf">30e6</span> <span class="n">xy</span> <span class="mf">0.0</span> <span class="n">yy</span> <span class="o">-</span><span class="mf">5e6</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>To quickly balance the model, absorbing boundary conditions are assigned to four boundaries in the model.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;up&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;bottom&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;right&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;left&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
<section id="set-the-outputs">
<h3>2.6 Set the Outputs<a class="headerlink" href="#set-the-outputs" title="Permalink to this heading">#</a></h3>
<ol class="arabic">
<li><dl>
<dt>Set the output interval to be every 2000 steps and output all fields variables and fracture variables. Control the output interval to a reasonable size could shorten the computation time but get a good understanding of the model.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">pv</span><span class="o">.</span><span class="n">interval</span> <span class="mi">2000</span>
<span class="n">of</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">pv</span><span class="o">.</span><span class="n">field</span> <span class="n">default</span>
<span class="n">of</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">pv</span><span class="o">.</span><span class="n">fracture</span> <span class="n">default</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>In this step, model will first achieve the equilibrium without excavation under in-situ stresses state. The result of velocity or kinematic ratio should be less than 1e-5.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">step</span> <span class="mi">50000</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Insert CZM after achieve the equlibrium of in-situ stresses</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">insert</span> <span class="s1">&#39;default&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">cohesive</span> <span class="s1">&#39;default&#39;</span> <span class="n">EM</span> <span class="n">ten</span> <span class="mf">1e6</span> <span class="n">coh</span> <span class="mf">20e6</span> <span class="n">fric</span> <span class="mf">0.8</span> <span class="n">GI</span> <span class="mi">2</span> <span class="n">GII</span> <span class="mi">40</span> 
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>One step excavation. Remove the elements in the “excavation” group.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">excavation</span> <span class="s1">&#39;excavation&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Clear the absorbing boundaries</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;up&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;bottom&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;right&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;left&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Add pressures at the external boundaries</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;right&#39;</span>  <span class="n">normal</span> <span class="mf">30e6</span>  
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;up&#39;</span>  <span class="n">normal</span> <span class="mf">5e6</span>  
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;bottom&#39;</span>  <span class="n">normal</span> <span class="mf">5e6</span>  
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;left&#39;</span> <span class="n">normal</span> <span class="mf">30e6</span> 
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>The program will run 500000 steps in total. In other words, it will output 25 files for reference.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">step</span> <span class="mi">500000</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Finalize the model and clear all the temporary memories.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">of</span><span class="o">.</span><span class="n">finalize</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p>Save the notepad and double click the .of file to run the program.</p></li>
</ol>
</section>
</section>
<section id="run-the-program">
<h2>3.0 Run the Program<a class="headerlink" href="#run-the-program" title="Permalink to this heading">#</a></h2>
<p>When you run the program, you can first check the mesh that was created by Gmsh as shown in Figure 2. If the mesh has a good quality, you can close the window to continue run the program.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/In_situ_stress.png"><img alt="Mesh of the sample" src="../_images/In_situ_stress.png" style="width: 597.0px; height: 559.8px;" /></a>
<figcaption>
<p><span class="caption-text">Figure 2: Mesh created by Gmsh</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Check the boundary conditions here. Absorbing boundary conditions are on for both normal and shear directions. In-situ stresses are applied to the boundaries.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/Insitu_BC.png"><img alt="Triangle elements" src="../_images/Insitu_BC.png" style="width: 651.0px; height: 183.6px;" /></a>
<figcaption>
<p><span class="caption-text">Figure 3: Check the mesh setting from command window</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="results">
<h2>4.0 Results<a class="headerlink" href="#results" title="Permalink to this heading">#</a></h2>
<p>The stress and displacement results here are for reference.</p>
</section>
<section id="full-script">
<h2>5.0 Full Script<a class="headerlink" href="#full-script" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://geogroup.utoronto.ca:9191/gitlab/xiaofeng.li/openfdem_solver/-/blob/main/openfdem%20src/src/test/UCS%20by%20gmsh/example_UCS.geo">Apply_Insitu_Stress.of</a> (click to download from Gitlab)</p></li>
</ul>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialization, this command is to clear the memory in your last run, it is not mandatory </span>
<span class="c1"># but strongly recommend.</span>
<span class="n">of</span><span class="o">.</span><span class="n">new</span>

<span class="c1"># Set the path folder of your output results, //result// in the same path of your input file </span>
<span class="c1"># will be created by default</span>
<span class="n">of</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">result</span> <span class="s2">&quot;result&quot;</span>

<span class="c1"># Set the number of cores you want to use, the parallization will be automatically turned on</span>
<span class="c1"># when you use the following command, otherwise the serilization will be used by default</span>
<span class="n">of</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">omp</span> <span class="mi">15</span>


<span class="c1">###################################### create mesh ##########################################</span>
<span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">square</span> <span class="s1">&#39;rock&#39;</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">cut</span><span class="o">.</span><span class="n">circle</span> <span class="s1">&#39;hole&#39;</span> <span class="s1">&#39;rock&#39;</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.05</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">size</span> <span class="s1">&#39;default&#39;</span> <span class="mf">0.03</span>
<span class="n">of</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">mesh</span> <span class="n">auto</span>

<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">element</span> <span class="s1">&#39;excavation&#39;</span> <span class="nb">range</span> <span class="n">circle</span><span class="o">.</span><span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.05</span><span class="p">]</span>

<span class="c1">################################# assign material parameters ################################</span>
<span class="c1"># Assign material for matrix.</span>
<span class="n">of</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">element</span> <span class="s1">&#39;default&#39;</span> <span class="n">elastic</span> <span class="n">den</span> <span class="mi">2700</span> <span class="n">E</span> <span class="mf">30e9</span> <span class="n">v</span> <span class="mf">0.3</span> <span class="n">damp</span> <span class="mf">1.0</span>
<span class="c1"># assign materials for contacts</span>
<span class="n">of</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">contact</span> <span class="s1">&#39;default&#39;</span> <span class="n">MC</span> <span class="n">fric</span> <span class="mf">0.3</span>

<span class="c1">##################################### create groups #########################################</span>
<span class="c1"># OpenFDEM can manually group the nodes, elements, cohesive elements and edges by using the </span>
<span class="c1"># region of box, circle and plane.</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;bottom&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;up&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;left&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">of</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">edge</span> <span class="s1">&#39;right&#39;</span> <span class="nb">range</span> <span class="n">plane</span><span class="o">.</span><span class="n">on</span> <span class="p">[</span><span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span><span class="p">]</span>

<span class="c1">################################### assign boundaries #######################################</span>
<span class="c1"># Set the in-situ stresses at the boundaries</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">stress</span> <span class="p">[</span><span class="n">rock</span><span class="p">]</span> <span class="n">xx</span> <span class="o">-</span><span class="mf">30e6</span> <span class="n">xy</span> <span class="mf">0.0</span> <span class="n">yy</span> <span class="o">-</span><span class="mf">5e6</span>

<span class="c1"># add absorbing boundary to quickly balance the model</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;up&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;bottom&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;right&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">viscous</span> <span class="s1">&#39;left&#39;</span>  <span class="n">normal</span> <span class="n">shear</span>

<span class="c1">####################################### set output ###########################################</span>
<span class="c1"># Set the interval of writing ParaView results.</span>
<span class="n">of</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">pv</span><span class="o">.</span><span class="n">interval</span> <span class="mi">2000</span>
<span class="c1"># Output all results by default.</span>
<span class="n">of</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">pv</span><span class="o">.</span><span class="n">field</span> <span class="n">default</span>
<span class="n">of</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">pv</span><span class="o">.</span><span class="n">fracture</span> <span class="n">default</span>

<span class="c1">##################################### execute model ###########################################</span>

<span class="c1"># Run the in-situ stress equilibrium step. Energy equilibrium is achieved when the maximum </span>
<span class="c1"># velocity is less than 1e-5 or the kinematic ratio is less than 1e-5 or the mechanical ratio </span>
<span class="c1"># is less than 1e-5</span>
<span class="n">of</span><span class="o">.</span><span class="n">step</span> <span class="mi">50000</span>

<span class="c1"># insert CZM after achieve the equlibrium of in-situ stresses</span>
<span class="n">of</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">insert</span> <span class="s1">&#39;default&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">cohesive</span> <span class="s1">&#39;default&#39;</span> <span class="n">EM</span> <span class="n">ten</span> <span class="mf">1e6</span> <span class="n">coh</span> <span class="mf">20e6</span> <span class="n">fric</span> <span class="mf">0.8</span> <span class="n">GI</span> <span class="mi">2</span> <span class="n">GII</span> <span class="mi">40</span> 
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">excavation</span> <span class="s1">&#39;excavation&#39;</span>

<span class="c1"># Clear the absorbing boundaries</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;up&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;bottom&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;right&#39;</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">clear</span> <span class="s1">&#39;left&#39;</span>

<span class="c1"># Add pressures at the external boundaries</span>
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;right&#39;</span>  <span class="n">normal</span> <span class="mf">30e6</span>  
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;up&#39;</span>  <span class="n">normal</span> <span class="mf">5e6</span>  
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;bottom&#39;</span>  <span class="n">normal</span> <span class="mf">5e6</span>  
<span class="n">of</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">pressure</span> <span class="s1">&#39;left&#39;</span> <span class="n">normal</span> <span class="mf">30e6</span> 

<span class="c1"># Run the excavation step</span>
<span class="n">of</span><span class="o">.</span><span class="n">step</span> <span class="mi">500000</span>

<span class="c1"># Finalize the model and clear the memory</span>
<span class="n">of</span><span class="o">.</span><span class="n">finalize</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pressure.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorial : Pressure Method</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="tutorial3_UCS_Test_with_Quadrangle_Elements.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorial 3: Create Uniaxial Compression Test with Quadrangle Element</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Grasselli&#39;s Geomechanics Group
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorial 4: Apply In-situ Stress</a><ul>
<li><a class="reference internal" href="#main-steps">1.0 Main Steps</a></li>
<li><a class="reference internal" href="#codes">2.0 Codes</a><ul>
<li><a class="reference internal" href="#initialize-the-model">2.1 Initialize the model</a></li>
<li><a class="reference internal" href="#create-the-geometry-and-the-mesh">2.2 Create the geometry and the mesh</a></li>
<li><a class="reference internal" href="#assign-material-properties">2.3 Assign Material Properties</a></li>
<li><a class="reference internal" href="#group-the-edges">2.4 Group the Edges</a></li>
<li><a class="reference internal" href="#assign-boundary-conditions">2.5 Assign Boundary Conditions</a></li>
<li><a class="reference internal" href="#set-the-outputs">2.6 Set the Outputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-the-program">3.0 Run the Program</a></li>
<li><a class="reference internal" href="#results">4.0 Results</a></li>
<li><a class="reference internal" href="#full-script">5.0 Full Script</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    </body>
</html>